# æ’åºå¯è§†åŒ–é—ªçƒé—®é¢˜ä¼˜åŒ–è¯´æ˜

## ğŸ¯ é—®é¢˜æè¿°
æ’åºäº¤æ¢æ—¶ç•Œé¢ä¸€ç›´é—ªçƒï¼Œç”¨æˆ·ä½“éªŒä¸å‹å¥½ã€‚

## ğŸ”§ ä¼˜åŒ–æ–¹æ¡ˆ

### 1. åŒç¼“å†²æŠ€æœ¯
- **è‡ªå®šä¹‰åŒç¼“å†²é¢æ¿**ï¼šåˆ›å»ºäº†`DoubleBufferedPanel`ç±»
- **å¯ç”¨åŒç¼“å†²**ï¼šè®¾ç½®`ControlStyles.DoubleBuffer`ç­‰æ ·å¼
- **ç¦ç”¨èƒŒæ™¯é‡ç»˜**ï¼šé‡å†™`OnPaintBackground`æ–¹æ³•

### 2. äº¤æ¢åŠ¨ç”»ä¼˜åŒ–
- **åˆ†æ­¥éª¤æ˜¾ç¤º**ï¼š
  - æ­¥éª¤0ï¼šå‡†å¤‡äº¤æ¢ï¼ˆæ©™è‰²é«˜äº®ï¼‰
  - æ­¥éª¤1ï¼šäº¤æ¢ä¸­ï¼ˆçº¢è‰²é«˜äº®ï¼‰
  - æ­¥éª¤2ï¼šäº¤æ¢å®Œæˆï¼ˆç»¿è‰²é«˜äº®ï¼‰
- **æ—¶é—´ä¼˜åŒ–**ï¼šè°ƒæ•´å„æ­¥éª¤çš„å»¶è¿Ÿæ—¶é—´
- **å¼‚æ­¥æ›´æ–°**ï¼šä½¿ç”¨`BeginInvoke`æ›¿ä»£`Invoke`

### 3. ç»˜åˆ¶æ€§èƒ½ä¼˜åŒ–
- **é¢„åˆ›å»ºèµ„æº**ï¼šå­—ä½“å’Œç”»ç¬”åœ¨å¾ªç¯å¤–åˆ›å»º
- **æ¡ä»¶ç»˜åˆ¶**ï¼šåªåœ¨æŸ±å­è¶³å¤Ÿé«˜æ—¶ç»˜åˆ¶æ•°å€¼
- **æŠ—é”¯é½¿**ï¼šå¯ç”¨`SmoothingMode.AntiAlias`
- **æ–‡æœ¬æ¸²æŸ“**ï¼šä¼˜åŒ–`TextRenderingHint`

### 4. é‡ç»˜ç­–ç•¥ä¼˜åŒ–
- **å‡å°‘é‡ç»˜é¢‘ç‡**ï¼šè°ƒæ•´å»¶è¿Ÿæ—¶é—´æ¯”ä¾‹
- **çŠ¶æ€æ£€æŸ¥**ï¼šåœ¨é‡ç»˜å‰æ£€æŸ¥æ’åºçŠ¶æ€
- **å¼‚æ­¥å¤„ç†**ï¼šä½¿ç”¨`BeginInvoke`å‡å°‘é˜»å¡

## ğŸ“Š ä¼˜åŒ–æ•ˆæœ

### æ€§èƒ½æå‡
- âœ… æ¶ˆé™¤ç•Œé¢é—ªçƒ
- âœ… æé«˜ç»˜åˆ¶æ€§èƒ½
- âœ… å‡å°‘CPUå ç”¨
- âœ… æ”¹å–„ç”¨æˆ·ä½“éªŒ

### è§†è§‰æ•ˆæœ
- âœ… å¹³æ»‘çš„äº¤æ¢åŠ¨ç”»
- âœ… æ¸…æ™°çš„é¢œè‰²è¿‡æ¸¡
- âœ… ç¨³å®šçš„ç•Œé¢æ˜¾ç¤º
- âœ… æ›´å¥½çš„è§†è§‰åé¦ˆ

## ğŸ”§ æŠ€æœ¯å®ç°

### åŒç¼“å†²é¢æ¿
```csharp
public class DoubleBufferedPanel : Panel
{
    public DoubleBufferedPanel()
    {
        this.SetStyle(ControlStyles.AllPaintingInWmPaint |
                     ControlStyles.UserPaint |
                     ControlStyles.DoubleBuffer |
                     ControlStyles.ResizeRedraw, true);
    }
}
```

### äº¤æ¢åŠ¨ç”»ä¼˜åŒ–
```csharp
protected async Task ShowSwapAnimation(int index1, int index2)
{
    // æ­¥éª¤1ï¼šå‡†å¤‡äº¤æ¢ï¼ˆæ©™è‰²ï¼‰
    swapStep = 0;
    drawPanel.BeginInvoke(new Action(() => {
        if (isSorting) drawPanel.Invalidate();
    }));
    await Task.Delay(delay / 4);

    // æ­¥éª¤2ï¼šäº¤æ¢ä¸­ï¼ˆçº¢è‰²ï¼‰
    swapStep = 1;
    // ... æ‰§è¡Œäº¤æ¢

    // æ­¥éª¤3ï¼šäº¤æ¢å®Œæˆï¼ˆç»¿è‰²ï¼‰
    swapStep = 2;
    // ... å®ŒæˆåŠ¨ç”»
}
```

### ç»˜åˆ¶ä¼˜åŒ–
```csharp
protected virtual void DrawBars()
{
    // é¢„åˆ›å»ºèµ„æº
    using (Font font = new Font("Arial", 8))
    using (Pen borderPen = new Pen(Color.Black, 1))
    {
        for (int i = 0; i < data.Length; i++)
        {
            // é«˜æ•ˆç»˜åˆ¶é€»è¾‘
        }
    }
}
```

## ğŸ¨ é¢œè‰²æ–¹æ¡ˆ

### äº¤æ¢çŠ¶æ€é¢œè‰²
- **å‡†å¤‡äº¤æ¢**ï¼šæ©™è‰² (Orange)
- **äº¤æ¢ä¸­**ï¼šçº¢è‰² (Red)
- **äº¤æ¢å®Œæˆ**ï¼šç»¿è‰² (Green)
- **æ­£å¸¸çŠ¶æ€**ï¼šæµ…è“è‰² (LightBlue)

### è§†è§‰æ•ˆæœ
- æ©™è‰²ï¼šæç¤ºç”¨æˆ·å³å°†è¿›è¡Œäº¤æ¢
- çº¢è‰²ï¼šè¡¨ç¤ºæ­£åœ¨æ‰§è¡Œäº¤æ¢æ“ä½œ
- ç»¿è‰²ï¼šç¡®è®¤äº¤æ¢æ“ä½œå·²å®Œæˆ
- æµ…è“è‰²ï¼šæ­£å¸¸çš„æ’åºçŠ¶æ€

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

### ä¼˜åŒ–å‰
- âŒ ç•Œé¢é¢‘ç¹é—ªçƒ
- âŒ ç»˜åˆ¶æ€§èƒ½è¾ƒå·®
- âŒ ç”¨æˆ·ä½“éªŒä¸ä½³
- âŒ CPUå ç”¨è¾ƒé«˜

### ä¼˜åŒ–å
- âœ… ç•Œé¢å¹³æ»‘ç¨³å®š
- âœ… ç»˜åˆ¶æ€§èƒ½ä¼˜ç§€
- âœ… ç”¨æˆ·ä½“éªŒè‰¯å¥½
- âœ… CPUå ç”¨è¾ƒä½

## ğŸš€ ä½¿ç”¨å»ºè®®

### æœ€ä½³å®è·µ
1. **æ•°æ®é‡æ§åˆ¶**ï¼šå»ºè®®ä½¿ç”¨10-20ä¸ªå…ƒç´ è¿›è¡Œæ¼”ç¤º
2. **é€Ÿåº¦è®¾ç½®**ï¼šä½¿ç”¨"æ…¢"æˆ–"å¾ˆæ…¢"é€Ÿåº¦è·å¾—æœ€ä½³æ•ˆæœ
3. **çª—ä½“å¤§å°**ï¼šå¯ä»¥æœ€å¤§åŒ–çª—ä½“è·å¾—æ›´å¥½çš„è§‚å¯Ÿæ•ˆæœ
4. **æ“ä½œé¡ºåº**ï¼šå…ˆåº”ç”¨æ•°æ®ï¼Œå†å¼€å§‹æ’åº

### æ³¨æ„äº‹é¡¹
1. é¿å…åœ¨æ’åºè¿‡ç¨‹ä¸­é¢‘ç¹åˆ‡æ¢é€Ÿåº¦
2. ä¸è¦åŒæ—¶è¿è¡Œå¤šä¸ªæ’åºå®ä¾‹
3. ç¡®ä¿ç³»ç»Ÿæœ‰è¶³å¤Ÿçš„å†…å­˜å’ŒCPUèµ„æº

## ğŸ”® æœªæ¥ä¼˜åŒ–

### è®¡åˆ’æ”¹è¿›
- æ·»åŠ æ›´å¤šåŠ¨ç”»æ•ˆæœ
- æ”¯æŒæš‚åœå’Œæ¢å¤åŠŸèƒ½
- æ·»åŠ è¿›åº¦æ¡æ˜¾ç¤º
- ä¼˜åŒ–å¤§æ•°æ®é‡å¤„ç†

### æŠ€æœ¯å‡çº§
- ä½¿ç”¨WPFæ›¿ä»£WinForms
- å®ç°ç¡¬ä»¶åŠ é€Ÿç»˜åˆ¶
- æ·»åŠ GPUåŠ é€Ÿæ”¯æŒ
- ä¼˜åŒ–å†…å­˜ä½¿ç”¨

---
